import{u as S,r as d,j as e,S as C,G as b,L as k}from"./index-Do0oqCrF.js";import{A as P,X as T}from"./x-circle-R2QugL6Y.js";import{A}from"./alert-triangle-Zf2J93i9.js";import{C as I}from"./check-circle-DoF3jqVf.js";function l({label:x,status:m,description:i}){return e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded border border-slate-200",children:[m?e.jsx(I,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}):e.jsx(T,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-800",children:x}),e.jsx("p",{className:"text-sm text-slate-600",children:i})]})]})}function L(){const x=S(),[m,i]=d.useState("Detecting..."),[a,h]=d.useState(null),[s,g]=d.useState(null);d.useEffect(()=>{j(),w(),f()},[]);const j=async()=>{try{const t=new RTCPeerConnection({iceServers:[]});t.createDataChannel("");const o=await t.createOffer();await t.setLocalDescription(o);let n=!1;const r=setTimeout(()=>{n||(i("Unable to detect (timeout)"),t.close())},5e3);t.onicecandidate=c=>{if(!c||!c.candidate||!c.candidate.candidate)return;const p=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(c.candidate.candidate);p&&!n&&(n=!0,i(p[1]),clearTimeout(r),t.onicecandidate=null,t.close())},t.onicegatheringstatechange=()=>{t.iceGatheringState==="complete"&&!n&&(clearTimeout(r),i("Private/Not detectable"),t.close())}}catch{i("Unable to detect")}},w=async()=>{try{const o=await(await fetch("https://api.ipify.org?format=json")).json(),r=await(await fetch(`https://ipapi.co/${o.ip}/json/`)).json();h({ip:o.ip,city:r.city,region:r.region,country:r.country_name,isp:r.org})}catch{h({ip:"Unable to detect",error:!0})}},f=()=>{const t={https:window.location.protocol==="https:",secureContext:window.isSecureContext,cookieSecure:document.cookie.includes("Secure"),hasServiceWorker:"serviceWorker"in navigator,hasCredentialsAPI:"credentials"in navigator,hasCrypto:"crypto"in window&&"subtle"in window.crypto,mixedContent:!1},o=y(),n=window.location.protocol==="https:",r=Object.values(t).filter(u=>u===!0).length,c=Object.keys(t).length;g({checks:t,doh:o,hsts:n,score:r,maxScore:c,percentage:Math.round(r/c*100)})},y=()=>({supported:"dns"in navigator||navigator.userAgent.includes("Firefox")||navigator.userAgent.includes("Chrome"),note:"DoH must be manually enabled in browser settings"}),N=t=>t>=80?"text-green-600":t>=50?"text-yellow-600":"text-red-600",v=t=>t>=80?"bg-green-50 border-green-200":t>=50?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-4 py-3",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("button",{onClick:()=>x("/"),className:"text-blue-600 hover:text-blue-700 flex items-center gap-2 text-sm font-medium",children:[e.jsx(P,{className:"w-4 h-4"}),"Back to Dashboard"]})})}),e.jsx("div",{className:"p-4 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(C,{className:"w-12 h-12 text-blue-600"}),e.jsx("h1",{className:"text-4xl font-bold text-slate-800",children:"Browser Security Scanner"})]}),e.jsx("p",{className:"text-slate-600",children:"Check your network info and browser security status"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"w-6 h-6 text-blue-600"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"Local IP Address"})]}),e.jsx("div",{className:"text-3xl font-mono text-slate-700",children:m})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(b,{className:"w-6 h-6 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold text-slate-800",children:"External IP Address"})]}),a?e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-mono text-slate-700 mb-3",children:a.ip}),!a.error&&e.jsxs("div",{className:"text-sm text-slate-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",a.city,", ",a.region,", ",a.country]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ISP:"})," ",a.isp]})]})]}):e.jsx(k,{className:"w-8 h-8 text-slate-400 animate-spin"})]})]}),s&&e.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 border-2 mb-6 ${v(s.percentage)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:"Browser Security Status"}),e.jsxs("div",{className:`text-3xl font-bold ${N(s.percentage)}`,children:[s.percentage,"%"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[e.jsx(l,{label:"HTTPS Connection",status:s.checks.https,description:"Your connection is encrypted"}),e.jsx(l,{label:"Secure Context",status:s.checks.secureContext,description:"Browser APIs are fully available"}),e.jsx(l,{label:"HSTS Enabled",status:s.hsts,description:"HTTP Strict Transport Security active"}),e.jsx(l,{label:"DNS over HTTPS",status:s.doh.supported,description:s.doh.note}),e.jsx(l,{label:"Crypto API Available",status:s.checks.hasCrypto,description:"Modern encryption support"}),e.jsx(l,{label:"Credentials API",status:s.checks.hasCredentialsAPI,description:"Password manager integration"})]}),s.percentage<80&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-100 border border-yellow-300 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-yellow-700 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-yellow-800",children:"Security Recommendations:"}),e.jsxs("ul",{className:"text-sm text-yellow-700 mt-2 space-y-1 list-disc list-inside",children:[!s.checks.https&&e.jsx("li",{children:"Always use HTTPS connections"}),!s.doh.supported&&e.jsx("li",{children:"Enable DNS over HTTPS in browser settings"}),e.jsx("li",{children:"Keep your browser updated to the latest version"}),e.jsx("li",{children:"Enable all security features in browser settings"})]})]})]})})]})]})})]})}export{L as default};
