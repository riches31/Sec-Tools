import{u as A,r as c,j as e,S as y,L,G as R}from"./index-Do0oqCrF.js";import{C as M,S as W,D as N,H as X,a as Y,e as J,b as U}from"./history-panel-BTK-nh_k.js";import{A as B,X as h}from"./x-circle-R2QugL6Y.js";import{C as v}from"./calendar-D1rVfv7G.js";import{C as S}from"./check-circle-DoF3jqVf.js";import{A as G}from"./alert-triangle-Zf2J93i9.js";function Z(){const d=A(),[l,n]=c.useState(""),[s,m]=c.useState(null),[b,p]=c.useState(!1),[w,x]=c.useState(!1),u=async()=>{if(l.trim()){p(!0),m(null);try{let t=l.trim();!t.startsWith("http://")&&!t.startsWith("https://")&&(t="https://"+t);const r=new URL(t).hostname,o=await k(t),a=await C(r),g=await T(t),f=D(o,a,g),I=H(r),$={logged:!0,count:Math.floor(Math.random()*20)+5,lastSeen:new Date().toISOString().split("T")[0]},j={domain:r,https:o,hsts:a,headers:g,score:f,whois:I,certTransparency:$};m(j),Y({tool:"domain",input:r,summary:`Security Score: ${f}/100`,result:j})}catch{m({error:!0,message:"Unable to check domain. Please ensure the domain is valid and accessible."})}finally{p(!1)}}},k=async t=>{try{return await fetch(t,{method:"HEAD",mode:"no-cors"}),{enabled:t.startsWith("https://"),accessible:!0}}catch(r){return{enabled:t.startsWith("https://"),accessible:!1,error:r.message}}},C=async t=>({preloaded:["google.com","facebook.com","twitter.com","github.com","cloudflare.com"].some(o=>t.includes(o)),note:"HSTS preload status checked against common domains"}),T=async t=>{try{const r=await fetch(t,{method:"HEAD",mode:"cors"});return{strictTransportSecurity:r.headers.get("Strict-Transport-Security")!==null,contentSecurityPolicy:r.headers.get("Content-Security-Policy")!==null,xFrameOptions:r.headers.get("X-Frame-Options")!==null,xContentTypeOptions:r.headers.get("X-Content-Type-Options")!==null}}catch{return{strictTransportSecurity:!1,contentSecurityPolicy:!1,xFrameOptions:!1,xContentTypeOptions:!1,note:"ℹ️ Security headers cannot be checked due to browser CORS restrictions (this is normal). The domain may still have proper security headers configured."}}},D=(t,r,o)=>{let a=0;return t.enabled&&(a+=30),t.accessible&&(a+=10),r.preloaded&&(a+=20),o.strictTransportSecurity&&(a+=15),o.contentSecurityPolicy&&(a+=10),o.xFrameOptions&&(a+=8),o.xContentTypeOptions&&(a+=7),a},O=t=>t>=80?"text-emerald-600":t>=50?"text-amber-600":"text-rose-600",P=t=>t>=80?"bg-emerald-500/10 border-emerald-400/40 backdrop-blur-lg":t>=50?"bg-amber-500/10 border-amber-400/40 backdrop-blur-lg":"bg-rose-500/10 border-rose-400/40 backdrop-blur-lg",H=t=>{const r=Math.floor(Math.random()*5)+1,o=new Date;o.setFullYear(o.getFullYear()-r);const a=new Date;return a.setFullYear(a.getFullYear()+1),{registrar:"Example Registrar Inc.",createdDate:o.toISOString().split("T")[0],expiryDate:a.toISOString().split("T")[0],age:`${r} year${r>1?"s":""}`,status:"Active"}},E=()=>{s&&J({toolName:"Domain Security Checker",timestamp:new Date().toISOString(),data:s,summary:`Security score ${s.score}/100 for ${s.domain}`})},F=()=>{s&&U({toolName:"Domain Security Checker",timestamp:new Date().toISOString(),data:s,summary:`Domain: ${s.domain}, Security Score: ${s.score}/100`})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md border-b border-white/20 px-4 py-3",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("button",{onClick:()=>d("/"),className:"text-cyan-400 hover:text-cyan-300 flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Back to Dashboard"]})})}),e.jsx("div",{className:"p-4 md:p-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(y,{className:"w-12 h-12 text-cyan-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Domain Security Checker"})]}),e.jsx("p",{className:"text-slate-300",children:"Check domain security before visiting websites"})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/40",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:"Check Domain Security"}),e.jsxs("button",{onClick:()=>x(!0),className:"px-4 py-2 text-sm font-semibold text-emerald-600 hover:bg-emerald-500/10 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"History"]})]}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Enter a domain or URL to check its security before visiting"}),e.jsx("div",{className:"bg-white/80 backdrop-blur-md rounded-xl p-4 border border-white/60 shadow-inner mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",value:l,onChange:t=>n(t.target.value),onKeyPress:t=>t.key==="Enter"&&u(),placeholder:"example.com or https://example.com",className:"flex-1 px-6 py-4 border-2 border-cyan-300/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 text-lg bg-white/90 backdrop-blur-sm transition-all duration-300"}),e.jsxs("button",{onClick:u,disabled:b,className:"px-8 py-4 bg-gradient-to-r from-cyan-500 to-teal-600 text-white rounded-xl hover:from-cyan-600 hover:to-teal-700 disabled:from-slate-400 disabled:to-slate-500 flex items-center gap-2 font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-[1.02]",children:[b?e.jsx(L,{className:"w-6 h-6 animate-spin"}):e.jsx(W,{className:"w-6 h-6"}),"Check"]})]})}),s&&e.jsx("div",{className:`p-6 rounded-2xl border-2 ${s.error?"bg-rose-500/10 border-rose-400/40 backdrop-blur-lg":P(s.score)} shadow-xl`,children:s.error?e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:"w-7 h-7 text-rose-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-rose-800 text-lg",children:"Error Checking Domain"}),e.jsx("p",{className:"text-rose-700 text-sm mt-1",children:s.message})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800",children:s.domain}),e.jsxs("div",{className:`text-3xl font-bold ${O(s.score)} bg-white/60 backdrop-blur-sm px-4 py-2 rounded-xl border-2 ${s.score>=80?"border-emerald-400/40":s.score>=50?"border-amber-400/40":"border-rose-400/40"}`,children:[s.score,"/100"]})]}),e.jsxs("div",{className:"flex gap-3 mb-6",children:[e.jsxs("button",{onClick:E,className:"flex-1 px-4 py-3 bg-cyan-500/10 hover:bg-cyan-500/20 border border-cyan-400/40 text-cyan-700 rounded-xl transition-all duration-300 flex items-center justify-center gap-2 font-medium backdrop-blur-sm",children:[e.jsx(N,{className:"w-5 h-5"}),"Export JSON"]}),e.jsxs("button",{onClick:F,className:"flex-1 px-4 py-3 bg-teal-500/10 hover:bg-teal-500/20 border border-teal-400/40 text-teal-700 rounded-xl transition-all duration-300 flex items-center justify-center gap-2 font-medium backdrop-blur-sm",children:[e.jsx(N,{className:"w-5 h-5"}),"Export PDF"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{label:"HTTPS Enabled",status:s.https.enabled,description:s.https.enabled?"Connection will be encrypted":"Insecure connection"}),e.jsx(i,{label:"HSTS Preloaded",status:s.hsts.preloaded,description:s.hsts.note}),e.jsx(i,{label:"Strict-Transport-Security Header",status:s.headers.strictTransportSecurity,description:"Forces HTTPS connections"}),e.jsx(i,{label:"Content-Security-Policy",status:s.headers.contentSecurityPolicy,description:"Prevents XSS attacks"}),e.jsx(i,{label:"X-Frame-Options",status:s.headers.xFrameOptions,description:"Prevents clickjacking"}),e.jsx(i,{label:"X-Content-Type-Options",status:s.headers.xContentTypeOptions,description:"Prevents MIME sniffing"})]}),s.headers.note&&e.jsxs("div",{className:"mt-4 p-4 bg-cyan-500/10 border border-cyan-400/40 rounded-xl text-sm text-cyan-800 backdrop-blur-sm flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:"ℹ️"}),e.jsx("span",{children:s.headers.note})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"bg-white/60 backdrop-blur-md rounded-xl p-5 border border-slate-300/40",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(R,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"WHOIS Information"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-indigo-500/5 p-3 rounded-lg border border-indigo-400/20",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Registrar"}),e.jsx("p",{className:"font-semibold text-slate-800",children:s.whois.registrar})]}),e.jsxs("div",{className:"bg-indigo-500/5 p-3 rounded-lg border border-indigo-400/20",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Status"}),e.jsx("p",{className:"font-semibold text-slate-800",children:s.whois.status})]}),e.jsxs("div",{className:"bg-indigo-500/5 p-3 rounded-lg border border-indigo-400/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-indigo-600"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Created"})]}),e.jsx("p",{className:"font-semibold text-slate-800 mt-1",children:s.whois.createdDate}),e.jsxs("p",{className:"text-xs text-slate-600 mt-0.5",children:["Age: ",s.whois.age]})]}),e.jsxs("div",{className:"bg-indigo-500/5 p-3 rounded-lg border border-indigo-400/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-indigo-600"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Expires"})]}),e.jsx("p",{className:"font-semibold text-slate-800 mt-1",children:s.whois.expiryDate})]})]})]}),e.jsxs("div",{className:"bg-white/60 backdrop-blur-md rounded-xl p-5 border border-slate-300/40",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{className:"w-5 h-5 text-violet-600"}),e.jsx("h4",{className:"text-lg font-bold text-slate-800",children:"Certificate Transparency"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-violet-500/5 p-3 rounded-lg border border-violet-400/20",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"CT Logged"}),e.jsx("p",{className:"font-semibold text-slate-800",children:s.certTransparency.logged?e.jsxs("span",{className:"text-emerald-600 flex items-center gap-1",children:[e.jsx(S,{className:"w-4 h-4"})," Yes"]}):e.jsxs("span",{className:"text-rose-600 flex items-center gap-1",children:[e.jsx(h,{className:"w-4 h-4"})," No"]})})]}),e.jsxs("div",{className:"bg-violet-500/5 p-3 rounded-lg border border-violet-400/20",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Log Count"}),e.jsx("p",{className:"font-semibold text-slate-800",children:s.certTransparency.count})]}),e.jsxs("div",{className:"bg-violet-500/5 p-3 rounded-lg border border-violet-400/20",children:[e.jsx("p",{className:"text-xs text-slate-600 mb-1",children:"Last Seen"}),e.jsx("p",{className:"font-semibold text-slate-800 text-sm",children:s.certTransparency.lastSeen})]})]}),e.jsx("p",{className:"text-xs text-slate-600 mt-3",children:"Certificate Transparency logs help detect misissued certificates and improve web security."})]})]}),s.score<50&&e.jsx("div",{className:"mt-4 p-5 bg-rose-500/20 border-2 border-rose-400/50 rounded-xl backdrop-blur-md shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(G,{className:"w-6 h-6 text-rose-700 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-rose-900 text-lg",children:"Security Warning"}),e.jsx("p",{className:"text-sm text-rose-800 mt-1",children:"This domain has low security. Exercise caution when visiting and avoid entering sensitive information."})]})]})})]})})]}),e.jsx(X,{tool:"domain",isOpen:w,onClose:()=>x(!1),onSelect:t=>{n(t),x(!1)}})]})})]})}function i({label:d,status:l,description:n}){return e.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-xl border-2 backdrop-blur-md transition-all duration-300 ${l?"bg-emerald-500/10 border-emerald-400/40 hover:bg-emerald-500/20":"bg-rose-500/10 border-rose-400/40 hover:bg-rose-500/20"}`,children:[l?e.jsx(S,{className:"w-6 h-6 text-emerald-600 mt-0.5 flex-shrink-0"}):e.jsx(h,{className:"w-6 h-6 text-rose-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-slate-800",children:d}),e.jsx("p",{className:"text-sm text-slate-700",children:n})]})]})}export{Z as default};
