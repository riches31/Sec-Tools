import{c as $,u as _,r as b,j as e,M as ee,S as se}from"./index-Do0oqCrF.js";import{C as te,D as ae,H as re,a as ie,e as ne,b as le}from"./history-panel-BTK-nh_k.js";import{A as oe,X as F}from"./x-circle-R2QugL6Y.js";import{A as R}from"./alert-triangle-Zf2J93i9.js";import{C as de}from"./check-circle-DoF3jqVf.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=$("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=$("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);function ge(){const u=_(),[a,m]=b.useState(""),[p,f]=b.useState(!1),[s,v]=b.useState(null),[S,C]=b.useState(null),[U,M]=b.useState(!1),O=async()=>{if(a.trim()){f(!0),C(null),v(null);try{const t=K(a);v(t),ie({tool:"email",input:a.substring(0,100)+"...",summary:`From: ${t.from}, Security Score: ${t.securityScore}/100`,result:t})}catch{C("Unable to parse email headers. Please ensure you have pasted complete email headers.")}finally{f(!1)}}},K=t=>{const l=t.split(`
`),i={};let g="";l.forEach(n=>{if(n.match(/^[A-Za-z-]+:/)){const[N,...y]=n.split(":");g=N.trim().toLowerCase(),i[g]=y.join(":").trim()}else g&&n.trim()&&(i[g]+=" "+n.trim())});const A=i.from||"Unknown",X=i.to||"Unknown",Z=i.subject||"No Subject",G=i.date||"Unknown",W=i["message-id"]||"Unknown",D=i["return-path"]||"Unknown",k=i["authentication-results"]||"",P=k.match(/spf=(pass|fail|none)/i),E=k.match(/dkim=(pass|fail|none)/i),I=k.match(/dmarc=(pass|fail|none)/i),r={spf:{status:P?.[1]?.toLowerCase()||"none",details:P?"SPF check completed":"No SPF record found"},dkim:{status:E?.[1]?.toLowerCase()||"none",details:E?"DKIM signature verified":"No DKIM signature found"},dmarc:{status:I?.[1]?.toLowerCase()||"none",details:I?"DMARC policy checked":"No DMARC policy found"}},Q=(t.match(/^Received:.*$/gim)||[]).map(n=>{const N=n.match(/from\s+([\w.-]+)/i),y=n.match(/by\s+([\w.-]+)/i),V=n.match(/\[([\d.]+)\]/),Y=n.match(/;\s*(.+)$/);return{from:N?.[1]||"Unknown",by:y?.[1]||"Unknown",timestamp:Y?.[1]||"Unknown",ip:V?.[1]}});let x=0;const o=[];r.spf.status==="fail"&&(x+=3,o.push("SPF check failed - sender may be forged")),r.dkim.status==="fail"&&(x+=2,o.push("DKIM signature invalid - message may be tampered")),r.dmarc.status==="fail"&&(x+=2,o.push("DMARC policy violation detected"));const H=A.match(/@([\w.-]+)/)?.[1],z=D.match(/@([\w.-]+)/)?.[1];H&&z&&H!==z&&(x+=2,o.push("From address domain differs from Return-Path domain"));let d=100;r.spf.status==="none"&&(d-=15),r.spf.status==="fail"&&(d-=30),r.dkim.status==="none"&&(d-=15),r.dkim.status==="fail"&&(d-=30),r.dmarc.status==="none"&&(d-=10),r.dmarc.status==="fail"&&(d-=20),o.length>0&&(d-=10*o.length);const c=[];return r.spf.status!=="pass"&&c.push("Implement SPF records for sender domain"),r.dkim.status!=="pass"&&c.push("Configure DKIM signing for outgoing emails"),r.dmarc.status!=="pass"&&c.push("Set up DMARC policy to prevent email spoofing"),o.length>0&&c.push("Exercise caution - this email shows signs of potential spoofing"),x>=5&&c.push("High spam score - verify sender before taking action"),c.length===0&&c.push("Email authentication is properly configured"),{from:A,to:X,subject:Z,date:G,messageId:W,returnPath:D,authentication:r,receivedChain:Q,spamScore:Math.min(10,x),spoofingIndicators:o,securityScore:Math.max(0,d),recommendations:c}},L=t=>t>=80?"text-emerald-600":t>=60?"text-amber-600":"text-rose-600",J=t=>t>=80?"bg-emerald-500/20 border-emerald-400/50":t>=60?"bg-amber-500/20 border-amber-400/50":"bg-rose-500/20 border-rose-400/50",T=t=>t>=80?"bg-gradient-to-r from-emerald-500 to-teal-600":t>=60?"bg-gradient-to-r from-amber-500 to-orange-500":"bg-gradient-to-r from-rose-500 to-red-600",j=t=>t==="pass"?e.jsx(de,{className:"w-5 h-5 text-emerald-600"}):t==="fail"?e.jsx(F,{className:"w-5 h-5 text-rose-600"}):e.jsx(R,{className:"w-5 h-5 text-amber-600"}),q=()=>{s&&ne({toolName:"Email Header Analyzer",timestamp:new Date().toISOString(),data:s,summary:`Email from ${s.from}, Security Score: ${s.securityScore}/100`})},B=()=>{s&&le({toolName:"Email Header Analyzer",timestamp:new Date().toISOString(),data:s,summary:`Security Score: ${s.securityScore}/100, Spam Score: ${s.spamScore}/10`})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md border-b border-white/20 px-4 py-3",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs("button",{onClick:()=>u("/"),className:"text-cyan-400 hover:text-cyan-300 flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(oe,{className:"w-4 h-4"}),"Back to Dashboard"]})})}),e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(ee,{className:"w-12 h-12 text-indigo-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Email Header Analyzer"})]}),e.jsx("p",{className:"text-slate-300",children:"Parse and analyze email headers for authentication and security"})]}),e.jsxs("div",{className:"bg-white/70 dark:bg-slate-800/70 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/40 dark:border-slate-700/40 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 dark:text-white",children:"Paste Email Headers"}),e.jsxs("button",{onClick:()=>M(!0),className:"px-4 py-2 text-sm font-semibold text-indigo-600 dark:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"History"]})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"Paste the full email headers to analyze authentication, routing, and potential security issues"}),e.jsx("div",{className:"bg-white/80 dark:bg-slate-700/80 backdrop-blur-md rounded-xl p-4 border border-white/60 dark:border-slate-600/60 shadow-inner mb-4",children:e.jsx("textarea",{value:a,onChange:t=>m(t.target.value),placeholder:`Paste complete email headers here...

Example:
From: sender@example.com
To: recipient@example.com
Subject: Test Email
Date: Mon, 01 Jan 2024 12:00:00 +0000
Authentication-Results: spf=pass; dkim=pass; dmarc=pass
...`,rows:8,className:"w-full px-6 py-4 border-2 border-indigo-300/50 dark:border-indigo-600/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 font-mono text-sm resize-none bg-white/90 dark:bg-slate-800/90 text-slate-800 dark:text-white backdrop-blur-sm transition-all duration-300"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:O,disabled:p,className:"flex-1 px-8 py-4 bg-gradient-to-r from-indigo-500 to-blue-600 text-white rounded-xl hover:from-indigo-600 hover:to-blue-700 disabled:from-slate-400 disabled:to-slate-500 flex items-center justify-center gap-2 font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-[1.02]",children:p?"Analyzing...":"Analyze Headers"}),a&&e.jsx("button",{onClick:()=>m(""),className:"px-6 py-4 text-rose-600 dark:text-rose-400 hover:bg-rose-500/10 rounded-xl transition-colors font-semibold",children:"Clear"})]})]}),S&&e.jsx("div",{className:"bg-rose-500/20 border-2 border-rose-400/50 rounded-2xl p-5 mb-6 backdrop-blur-md shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(F,{className:"w-6 h-6 text-rose-600 dark:text-rose-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-rose-900 dark:text-rose-300 text-lg",children:"Analysis Failed"}),e.jsx("p",{className:"text-sm text-rose-800 dark:text-rose-400 mt-1",children:S})]})]})}),s&&e.jsxs("div",{className:`bg-white/70 dark:bg-slate-800/70 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border-2 mb-6 ${J(s.securityScore)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Analysis Results"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:q,className:"px-4 py-2 text-sm font-semibold text-indigo-600 dark:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-colors",children:"JSON"}),e.jsxs("button",{onClick:B,className:"px-4 py-2 text-sm font-semibold text-indigo-600 dark:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"PDF"]})]})]}),e.jsxs("div",{className:"mb-6 bg-white/60 dark:bg-slate-700/60 backdrop-blur-sm rounded-xl p-5 border border-white/60 dark:border-slate-600/60 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-base font-semibold text-slate-800 dark:text-white",children:"Security Score"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Spam Score: ",e.jsxs("span",{className:"font-bold text-rose-600",children:[s.spamScore,"/10"]})]}),e.jsxs("span",{className:`text-3xl font-bold ${L(s.securityScore)} bg-white/60 dark:bg-slate-800/60 px-4 py-2 rounded-xl`,children:[s.securityScore,"/100"]})]})]}),e.jsx("div",{className:"w-full bg-slate-200/50 dark:bg-slate-900/50 backdrop-blur-sm rounded-full h-4 shadow-inner",children:e.jsx("div",{className:`h-4 rounded-full transition-all duration-500 shadow-lg ${T(s.securityScore)}`,style:{width:`${s.securityScore}%`}})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsx(h,{label:"From",value:s.from}),e.jsx(h,{label:"To",value:s.to}),e.jsx(h,{label:"Subject",value:s.subject}),e.jsx(h,{label:"Date",value:s.date}),e.jsx(h,{label:"Message-ID",value:s.messageId,mono:!0}),e.jsx(h,{label:"Return-Path",value:s.returnPath})]}),e.jsxs("div",{className:"mb-6 bg-white/60 dark:bg-slate-700/60 backdrop-blur-sm rounded-xl p-5 border border-white/60 dark:border-slate-600/60",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white mb-4",children:"Email Authentication"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx(w,{label:"SPF",status:s.authentication.spf.status,details:s.authentication.spf.details,icon:j(s.authentication.spf.status)}),e.jsx(w,{label:"DKIM",status:s.authentication.dkim.status,details:s.authentication.dkim.details,icon:j(s.authentication.dkim.status)}),e.jsx(w,{label:"DMARC",status:s.authentication.dmarc.status,details:s.authentication.dmarc.details,icon:j(s.authentication.dmarc.status)})]})]}),s.receivedChain.length>0&&e.jsxs("div",{className:"mb-6 bg-white/60 dark:bg-slate-700/60 backdrop-blur-sm rounded-xl p-5 border border-white/60 dark:border-slate-600/60",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5"}),"Email Routing Path (",s.receivedChain.length," hops)"]}),e.jsx("div",{className:"space-y-3",children:s.receivedChain.map((t,l)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/40 dark:bg-slate-800/40 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-500/20 rounded-full flex items-center justify-center text-sm font-bold text-indigo-600 dark:text-indigo-400",children:l+1}),e.jsxs("div",{className:"flex-1 text-sm",children:[e.jsxs("p",{className:"text-slate-800 dark:text-white font-medium",children:["From: ",e.jsx("span",{className:"font-mono",children:t.from})," → By: ",e.jsx("span",{className:"font-mono",children:t.by})]}),t.ip&&e.jsxs("p",{className:"text-slate-600 dark:text-slate-400 flex items-center gap-1 mt-1",children:[e.jsx(ce,{className:"w-3 h-3"}),"IP: ",t.ip]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-500 text-xs mt-1",children:t.timestamp})]})]},l))})]}),s.spoofingIndicators.length>0&&e.jsxs("div",{className:"mb-6 p-5 bg-rose-500/20 border-2 border-rose-400/50 rounded-xl backdrop-blur-md shadow-lg",children:[e.jsxs("h3",{className:"font-bold text-rose-900 dark:text-rose-300 mb-3 flex items-center gap-2 text-lg",children:[e.jsx(R,{className:"w-6 h-6"}),"Security Warnings"]}),e.jsx("ul",{className:"space-y-2",children:s.spoofingIndicators.map((t,l)=>e.jsxs("li",{className:"text-sm text-rose-800 dark:text-rose-400 flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 text-base",children:"⚠"}),e.jsx("span",{children:t})]},l))})]}),e.jsxs("div",{className:"p-5 bg-indigo-500/10 border-2 border-indigo-400/40 rounded-xl backdrop-blur-md shadow-lg",children:[e.jsx("h3",{className:"font-bold text-indigo-900 dark:text-indigo-300 mb-3",children:"Recommendations"}),e.jsx("ul",{className:"space-y-2",children:s.recommendations.map((t,l)=>e.jsxs("li",{className:"text-sm text-indigo-800 dark:text-indigo-400 flex items-start gap-2",children:[e.jsx("span",{className:"mt-1",children:"•"}),e.jsx("span",{children:t})]},l))})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500/10 to-blue-500/10 border-2 border-indigo-400/40 rounded-2xl p-6 backdrop-blur-md shadow-lg",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}),"Email Authentication Information"]}),e.jsxs("ul",{className:"space-y-3 text-sm text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"SPF"})," verifies that the sending server is authorized to send email for the domain"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"DKIM"})," uses cryptographic signatures to verify the email hasn't been tampered with"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"DMARC"})," tells receiving servers what to do if SPF or DKIM checks fail"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-indigo-600 dark:text-indigo-400 font-bold",children:"•"}),e.jsx("span",{children:`Check the "Received" chain to trace the email's route from sender to recipient`})]})]})]})]}),e.jsx(re,{tool:"email",onSelect:t=>m(t),isOpen:U,onClose:()=>M(!1)})]})]})}function h({label:u,value:a,mono:m=!1}){return e.jsxs("div",{className:"p-4 rounded-xl border-2 backdrop-blur-md transition-all duration-300 bg-white/40 dark:bg-slate-700/40 border-white/40 dark:border-slate-600/40 hover:bg-white/60 dark:hover:bg-slate-700/60",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 block mb-2",children:u}),e.jsx("p",{className:`text-slate-800 dark:text-white ${m?"font-mono text-xs":"text-sm"} break-all`,children:a})]})}function w({label:u,status:a,details:m,icon:p}){const f=a==="pass"?"bg-emerald-500/10":a==="fail"?"bg-rose-500/10":"bg-amber-500/10",s=a==="pass"?"border-emerald-400/40":a==="fail"?"border-rose-400/40":"border-amber-400/40";return e.jsxs("div",{className:`p-4 rounded-xl border-2 ${f} ${s} backdrop-blur-sm`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:u}),p]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 uppercase font-semibold mb-1",children:a}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:m})]})}export{ge as default};
