const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-DxFXFRbJ.js","assets/index-Do0oqCrF.js","assets/index-lzIYyNNP.css"])))=>i.map(i=>d[i]);
import{c as m,_ as k,r as g,j as s,X as w}from"./index-Do0oqCrF.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=m("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=m("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=m("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=m("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),v="sec-tools-history",N=10;function u(t){return`${v}-${t}`}function P(t){const n=u(t.tool),e=p(t.tool),l={...t,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};e.unshift(l);const a=e.slice(0,N);try{localStorage.setItem(n,JSON.stringify(a))}catch(r){console.error("Failed to save to history:",r),r instanceof DOMException&&r.name==="QuotaExceededError"&&(b(t.tool),localStorage.setItem(n,JSON.stringify([l])))}}function p(t){const n=u(t);try{const e=localStorage.getItem(n);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load history:",e),[]}}function C(t,n){const l=p(t).filter(r=>r.id!==n),a=u(t);try{localStorage.setItem(a,JSON.stringify(l))}catch(r){console.error("Failed to delete history entry:",r)}}function b(t){const n=u(t);try{localStorage.removeItem(n)}catch(e){console.error("Failed to clear history:",e)}}function D(t){const e=Date.now()-t,l=Math.floor(e/6e4),a=Math.floor(e/36e5),r=Math.floor(e/864e5);return l<1?"Just now":l<60?`${l}m ago`:a<24?`${a}h ago`:r<7?`${r}d ago`:new Date(t).toLocaleDateString()}function H(t){const n={...t,exportedAt:new Date().toISOString(),version:"1.0",source:"Security Tools Suite"},e=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),l=URL.createObjectURL(e),a=document.createElement("a");a.href=l,a.download=`${t.toolName.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)}async function L(t){try{const{jsPDF:n}=await k(async()=>{const{jsPDF:c}=await import("./jspdf.es.min-DxFXFRbJ.js").then(h=>h.j);return{jsPDF:c}},__vite__mapDeps([0,1,2])),e=new n,l=e.internal.pageSize.getWidth(),a=e.internal.pageSize.getHeight(),r=20;let o=r;if(e.setFontSize(20),e.setTextColor(14,116,144),e.text("Security Tools Suite",r,o),o+=10,e.setFontSize(16),e.setTextColor(51,65,85),e.text(t.toolName,r,o),o+=10,e.setFontSize(10),e.setTextColor(100,116,139),e.text(`Generated: ${new Date().toLocaleString()}`,r,o),o+=5,e.setDrawColor(226,232,240),e.line(r,o,l-r,o),o+=10,t.summary){e.setFontSize(12),e.setTextColor(51,65,85),e.text("Summary:",r,o),o+=7,e.setFontSize(10),e.setTextColor(71,85,105);const c=e.splitTextToSize(t.summary,l-2*r);e.text(c,r,o),o+=c.length*5+10}e.setFontSize(12),e.setTextColor(51,65,85),e.text("Report Data:",r,o),o+=10,e.setFontSize(9),e.setTextColor(71,85,105);const y=JSON.stringify(t.data,null,2);e.splitTextToSize(y,l-2*r).forEach(c=>{o>a-r&&(e.addPage(),o=r),e.text(c,r,o),o+=4});const x=e.getNumberOfPages();for(let c=1;c<=x;c++)e.setPage(c),e.setFontSize(8),e.setTextColor(148,163,184),e.text(`Security Tools Suite | Page ${c} of ${x} | https://yoursite.com`,l/2,a-10,{align:"center"});e.save(`${t.toolName.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}.pdf`)}catch(n){console.error("PDF export failed:",n),alert("Failed to export PDF. Please try again.")}}function E({tool:t,onSelect:n,isOpen:e,onClose:l}){const[a,r]=g.useState([]),[o,y]=g.useState("");g.useEffect(()=>{e&&d()},[e,t]);const d=()=>{const i=p(t);r(i)},x=i=>{C(t,i),d()},c=()=>{confirm("Are you sure you want to clear all history for this tool?")&&(b(t),d())},h=o?a.filter(i=>i.input.toLowerCase().includes(o.toLowerCase())):a;return e?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-white/90 dark:bg-slate-800/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/40 dark:border-slate-700/40 w-full max-w-2xl max-h-[80vh] overflow-hidden mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200/50 dark:border-slate-700/50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(f,{className:"w-6 h-6 text-cyan-600 dark:text-cyan-400"}),s.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Recent Checks"})]}),s.jsx("button",{onClick:l,className:"p-2 rounded-lg hover:bg-slate-200/50 dark:hover:bg-slate-700/50 transition-colors",children:s.jsx(w,{className:"w-5 h-5 text-slate-600 dark:text-slate-300"})})]}),a.length>0&&s.jsx("div",{className:"p-4 border-b border-slate-200/50 dark:border-slate-700/50",children:s.jsxs("div",{className:"relative",children:[s.jsx(S,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),s.jsx("input",{type:"text",value:o,onChange:i=>y(i.target.value),placeholder:"Search history...",className:"w-full pl-10 pr-4 py-2 border-2 border-slate-300/50 dark:border-slate-600/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 bg-white/50 dark:bg-slate-700/50 text-slate-800 dark:text-white"})]})}),s.jsx("div",{className:"p-4 overflow-y-auto max-h-[calc(80vh-200px)]",children:h.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(f,{className:"w-16 h-16 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),s.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:o?"No matching history found":"No recent checks yet"}),s.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-500 mt-2",children:"Your recent checks will appear here"})]}):s.jsx("div",{className:"space-y-2",children:h.map(i=>s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-white/60 dark:bg-slate-700/60 backdrop-blur-sm rounded-xl border border-slate-200/50 dark:border-slate-600/50 hover:bg-white/80 dark:hover:bg-slate-700/80 transition-all group",children:[s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("button",{onClick:()=>{n(i.input),l()},className:"w-full text-left",children:[s.jsx("p",{className:"font-mono text-sm text-slate-800 dark:text-slate-200 truncate",children:i.input}),i.summary&&s.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 mt-1 truncate",children:i.summary}),s.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500 mt-1",children:D(i.timestamp)})]})}),s.jsx("button",{onClick:()=>x(i.id),className:"opacity-0 group-hover:opacity-100 p-2 rounded-lg hover:bg-rose-500/20 transition-all",title:"Delete entry",children:s.jsx(j,{className:"w-4 h-4 text-rose-600 dark:text-rose-400"})})]},i.id))})}),a.length>0&&s.jsxs("div",{className:"p-4 border-t border-slate-200/50 dark:border-slate-700/50 flex justify-between items-center",children:[s.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[a.length," ",a.length===1?"entry":"entries"]}),s.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-semibold text-rose-600 dark:text-rose-400 hover:bg-rose-500/10 rounded-lg transition-colors",children:"Clear All"})]})]})}):null}export{f as C,F as D,E as H,S,P as a,L as b,H as e};
