import{u as I,r as c,j as e,a as u,L as V,S as A}from"./index-Do0oqCrF.js";import{C,S as U,D as M,H as J,a as K,e as X,b as B}from"./history-panel-BTK-nh_k.js";import{A as G,X as D}from"./x-circle-R2QugL6Y.js";import{C as T}from"./calendar-D1rVfv7G.js";import{C as W}from"./check-circle-DoF3jqVf.js";import{A as q}from"./alert-triangle-Zf2J93i9.js";function se(){const p=I(),[o,x]=c.useState(""),[m,b]=c.useState(!1),[s,j]=c.useState(null),[N,S]=c.useState(null),[L,k]=c.useState(!1),w=async()=>{if(o.trim()){b(!0),S(null),j(null);try{let t=o.trim().toLowerCase();t=t.replace(/^https?:\/\//,""),t=t.split("/")[0];const a=await E(t);j(a),K({tool:"ssl",input:t,summary:`Trust Score: ${a.trustScore}/100, Expires in ${a.daysRemaining} days`,result:a})}catch{S("Unable to analyze certificate. Please ensure the domain is valid and accessible via HTTPS.")}finally{b(!1)}}},E=async t=>{await new Promise(F=>setTimeout(F,1500));const a=new Date(Date.now()-4320*60*60*1e3),y=new Date(Date.now()+4440*60*60*1e3),h=Math.floor((y.getTime()-Date.now())/(1440*60*1e3)),f=h<0,v=h<30&&h>0,n=t.includes("localhost")||t.includes("127.0.0.1");let l=100;const d=[],i=[];n&&(l-=50,d.push("Self-signed certificate detected"),i.push("Use a certificate from a trusted Certificate Authority (CA)")),f?(l-=30,d.push("Certificate has expired"),i.push("Renew your SSL certificate immediately")):v&&(l-=10,d.push("Certificate expiring soon"),i.push("Renew certificate before expiration"));const g="SHA256withRSA";(g.includes("SHA1")||g.includes("MD5"))&&(l-=20,d.push("Weak signature algorithm detected"),i.push("Upgrade to SHA-256 or higher"));const P=2048;return l===100&&!n&&i.push("Certificate configuration is excellent! No action needed."),{domain:t,issuer:n?"Self-Signed":"Let's Encrypt Authority X3",validFrom:a.toISOString().split("T")[0],validTo:y.toISOString().split("T")[0],daysRemaining:h,serialNumber:"0x"+Math.random().toString(16).substr(2,16).toUpperCase(),signatureAlgorithm:g,publicKeyAlgorithm:"RSA",keySize:P,subjectAltNames:[t,`www.${t}`],isValid:!f&&!n,isSelfSigned:n,isExpired:f,isExpiringSoon:v,trustScore:Math.max(0,l),vulnerabilities:d,recommendations:i}},$=t=>t>=80?"text-emerald-600":t>=60?"text-amber-600":"text-rose-600",z=t=>t>=80?"bg-emerald-500/20 border-emerald-400/50":t>=60?"bg-amber-500/20 border-amber-400/50":"bg-rose-500/20 border-rose-400/50",O=t=>t>=80?"bg-gradient-to-r from-emerald-500 to-teal-600":t>=60?"bg-gradient-to-r from-amber-500 to-orange-500":"bg-gradient-to-r from-rose-500 to-red-600",R=()=>{s&&X({toolName:"SSL Certificate Analyzer",timestamp:new Date().toISOString(),data:s,summary:`SSL certificate analysis for ${s.domain}`})},H=()=>{s&&B({toolName:"SSL Certificate Analyzer",timestamp:new Date().toISOString(),data:s,summary:`Trust Score: ${s.trustScore}/100, Valid until ${s.validTo}, ${s.daysRemaining} days remaining`})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur-md border-b border-white/20 px-4 py-3",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("button",{onClick:()=>p("/"),className:"text-cyan-400 hover:text-cyan-300 flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Back to Dashboard"]})})}),e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(u,{className:"w-12 h-12 text-teal-500"}),e.jsx("h1",{className:"text-4xl font-bold text-white",children:"SSL/TLS Certificate Analyzer"})]}),e.jsx("p",{className:"text-slate-300",children:"Analyze SSL certificates for security and validity"})]}),e.jsxs("div",{className:"bg-white/70 dark:bg-slate-800/70 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/40 dark:border-slate-700/40 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 dark:text-white",children:"Enter Domain"}),e.jsxs("button",{onClick:()=>k(!0),className:"px-4 py-2 text-sm font-semibold text-teal-600 dark:text-teal-400 hover:bg-teal-500/10 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"History"]})]}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"Enter a domain name to analyze its SSL/TLS certificate"}),e.jsx("div",{className:"bg-white/80 dark:bg-slate-700/80 backdrop-blur-md rounded-xl p-4 border border-white/60 dark:border-slate-600/60 shadow-inner",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",value:o,onChange:t=>x(t.target.value),onKeyPress:t=>t.key==="Enter"&&w(),placeholder:"example.com",className:"flex-1 px-6 py-4 border-2 border-teal-300/50 dark:border-teal-600/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-lg bg-white/90 dark:bg-slate-800/90 text-slate-800 dark:text-white backdrop-blur-sm transition-all duration-300"}),e.jsxs("button",{onClick:w,disabled:m,className:"px-8 py-4 bg-gradient-to-r from-teal-500 to-cyan-600 text-white rounded-xl hover:from-teal-600 hover:to-cyan-700 disabled:from-slate-400 disabled:to-slate-500 flex items-center gap-2 font-semibold transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-[1.02]",children:[m?e.jsx(V,{className:"w-6 h-6 animate-spin"}):e.jsx(U,{className:"w-6 h-6"}),"Analyze"]})]})})]}),N&&e.jsx("div",{className:"bg-rose-500/20 border-2 border-rose-400/50 rounded-2xl p-5 mb-6 backdrop-blur-md shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-rose-600 dark:text-rose-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-rose-900 dark:text-rose-300 text-lg",children:"Analysis Failed"}),e.jsx("p",{className:"text-sm text-rose-800 dark:text-rose-400 mt-1",children:N})]})]})}),s&&e.jsxs("div",{className:`bg-white/70 dark:bg-slate-800/70 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border-2 mb-6 ${z(s.trustScore)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Certificate Analysis"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:R,className:"px-4 py-2 text-sm font-semibold text-teal-600 dark:text-teal-400 hover:bg-teal-500/10 rounded-lg transition-colors",title:"Export as JSON",children:"JSON"}),e.jsxs("button",{onClick:H,className:"px-4 py-2 text-sm font-semibold text-teal-600 dark:text-teal-400 hover:bg-teal-500/10 rounded-lg transition-colors flex items-center gap-2",title:"Export as PDF",children:[e.jsx(M,{className:"w-4 h-4"}),"PDF"]})]})]}),e.jsxs("div",{className:"mb-6 bg-white/60 dark:bg-slate-700/60 backdrop-blur-sm rounded-xl p-5 border border-white/60 dark:border-slate-600/60 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-base font-semibold text-slate-800 dark:text-white",children:"Trust Score"}),e.jsxs("span",{className:`text-3xl font-bold ${$(s.trustScore)} bg-white/60 dark:bg-slate-800/60 px-4 py-2 rounded-xl`,children:[s.trustScore,"/100"]})]}),e.jsx("div",{className:"w-full bg-slate-200/50 dark:bg-slate-900/50 backdrop-blur-sm rounded-full h-4 shadow-inner",children:e.jsx("div",{className:`h-4 rounded-full transition-all duration-500 shadow-lg ${O(s.trustScore)}`,style:{width:`${s.trustScore}%`}})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsx(r,{icon:e.jsx(A,{}),label:"Issuer",value:s.issuer}),e.jsx(r,{icon:e.jsx(u,{}),label:"Serial Number",value:s.serialNumber,mono:!0}),e.jsx(r,{icon:e.jsx(T,{}),label:"Valid From",value:s.validFrom}),e.jsx(r,{icon:e.jsx(T,{}),label:"Valid Until",value:s.validTo}),e.jsx(r,{icon:e.jsx(C,{}),label:"Days Remaining",value:`${s.daysRemaining} days`,highlight:s.isExpiringSoon||s.isExpired}),e.jsx(r,{icon:e.jsx(u,{}),label:"Signature Algorithm",value:s.signatureAlgorithm}),e.jsx(r,{icon:e.jsx(u,{}),label:"Public Key",value:`${s.publicKeyAlgorithm} (${s.keySize} bits)`}),e.jsx(r,{icon:s.isValid?e.jsx(W,{}):e.jsx(D,{}),label:"Status",value:s.isExpired?"Expired":s.isSelfSigned?"Self-Signed":"Valid",highlight:!s.isValid})]}),s.subjectAltNames.length>0&&e.jsxs("div",{className:"mb-6 bg-white/60 dark:bg-slate-700/60 backdrop-blur-sm rounded-xl p-5 border border-white/60 dark:border-slate-600/60",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-white mb-3",children:"Subject Alternative Names"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.subjectAltNames.map((t,a)=>e.jsx("span",{className:"px-3 py-1.5 bg-teal-500/10 text-teal-700 dark:text-teal-300 rounded-lg text-sm font-medium border border-teal-400/40",children:t},a))})]}),s.vulnerabilities.length>0&&e.jsxs("div",{className:"mb-6 p-5 bg-rose-500/20 border-2 border-rose-400/50 rounded-xl backdrop-blur-md shadow-lg",children:[e.jsxs("h3",{className:"font-bold text-rose-900 dark:text-rose-300 mb-3 flex items-center gap-2 text-lg",children:[e.jsx(q,{className:"w-6 h-6"}),"Vulnerabilities Detected"]}),e.jsx("ul",{className:"space-y-2",children:s.vulnerabilities.map((t,a)=>e.jsxs("li",{className:"text-sm text-rose-800 dark:text-rose-400 flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 text-base",children:"âš "}),e.jsx("span",{children:t})]},a))})]}),e.jsxs("div",{className:"p-5 bg-teal-500/10 border-2 border-teal-400/40 rounded-xl backdrop-blur-md shadow-lg",children:[e.jsx("h3",{className:"font-bold text-teal-900 dark:text-teal-300 mb-3",children:"Recommendations"}),e.jsx("ul",{className:"space-y-2",children:s.recommendations.map((t,a)=>e.jsxs("li",{className:"text-sm text-teal-800 dark:text-teal-400 flex items-start gap-2",children:[e.jsx("span",{className:"mt-1",children:"â€¢"}),e.jsx("span",{children:t})]},a))})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-teal-500/10 to-cyan-500/10 border-2 border-teal-400/40 rounded-2xl p-6 backdrop-blur-md shadow-lg",children:[e.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6 text-teal-600 dark:text-teal-400"}),"SSL/TLS Certificate Information"]}),e.jsxs("ul",{className:"space-y-3 text-sm text-slate-700 dark:text-slate-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-teal-600 dark:text-teal-400 font-bold",children:"â€¢"}),e.jsx("span",{children:"SSL certificates encrypt data between your browser and the server"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-teal-600 dark:text-teal-400 font-bold",children:"â€¢"}),e.jsx("span",{children:"Certificates should be renewed before expiration to avoid service interruption"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-teal-600 dark:text-teal-400 font-bold",children:"â€¢"}),e.jsx("span",{children:"Use certificates from trusted Certificate Authorities (CAs) like Let's Encrypt"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-teal-600 dark:text-teal-400 font-bold",children:"â€¢"}),e.jsx("span",{children:"Modern certificates should use SHA-256 or higher and at least 2048-bit keys"})]})]})]})]}),e.jsx(J,{tool:"ssl",onSelect:t=>x(t),isOpen:L,onClose:()=>k(!1)})]})]})}function r({icon:p,label:o,value:x,mono:m=!1,highlight:b=!1}){return e.jsxs("div",{className:`p-4 rounded-xl border-2 backdrop-blur-md transition-all duration-300 ${b?"bg-amber-500/10 border-amber-400/40":"bg-white/40 dark:bg-slate-700/40 border-white/40 dark:border-slate-600/40 hover:bg-white/60 dark:hover:bg-slate-700/60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-teal-600 dark:text-teal-400",children:p}),e.jsx("span",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:o})]}),e.jsx("p",{className:`text-slate-800 dark:text-white ${m?"font-mono text-sm":""}`,children:x})]})}export{se as default};
